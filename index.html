<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Timer</title>
	<style>
		* {
			box-sizing: border-box;
			/* font-family: 'Inter Var', 'Inter'; */
			font-family: 'JetBrains Mono';
			font-size: 64pt;
			color: #ff1040;
		}

		html {
			margin: 0px;
			width: 100vw;
			height: 100vh;
			overflow: hidden;
			background-color: transparent;
		}

		body {
			margin: 0px;
			width: 100%;
			height: 100%;
			border-radius: 128px;
			overflow: hidden;
			background-color: transparent;
		}

		main {
			display: flex;
			justify-content: center;
			align-items: center;
			margin: 0;
			width: 100%;
			height: 100%;
			background-color: #000000c0;
		}

		#clock>span {
			color: #fff;
			/* text-align: center;
			display: inline-block;
			width: 120pt; */
		}

		/* #clock.elapsed>span {
			color: #10ff40;
		} */
		#clock.elapsed {
			color: #10ff40;
		}
	</style>
</head>

<body>
	<main>
		<div id="clock">
			<span id="hours"></span>:<span id="minutes"></span>:<span id="seconds"></span>
		</div>
	</main>
</body>

<script>

	const hoursSpan = document.getElementById('hours');
	const minutesSpan = document.getElementById('minutes');
	const secondsSpan = document.getElementById('seconds');
	const clockDiv = document.getElementById('clock');

	/** @type {number} */
	let hours;
	/** @type {number} */
	let minutes;
	/** @type {number} */
	let seconds;

	let start = Date.now();

	{
		let usp = new URLSearchParams(window.location.search);
		hours = parseInt(usp.get("h")) || 0;
		minutes = parseInt(usp.get("m")) || 0;
		seconds = parseInt(usp.get("s")) || 0;
	}

	console.log("hours =", hours);
	console.log("minutes =", minutes);
	console.log("seconds =", seconds);

	let duration = (hours * 1000 * 60 * 60)
		+ (minutes * 1000 * 60)
		+ (seconds * 1000);
	let end = start + duration;

	let interval = setInterval(updateClock, 1000 / 500);

	function updateClock() {
		let delta = end - Date.now();
		hoursSpan.innerText = Math.max(0, (Math.floor(delta / 1000 / 60 / 60))).toString().padStart(2, '0');
		minutesSpan.innerText = Math.max(0, (Math.floor(delta / 1000 / 60)) % 60).toString().padStart(2, '0');
		secondsSpan.innerText = Math.max(0, (Math.floor(10 * delta / 1000) / 10) % 60).toFixed(1).padStart(4, '0');
		if (Date.now() > end) {
			clearInterval(interval);
			clockDiv.classList.add("elapsed");
		}
	}

	updateClock();


</script>

</html>
